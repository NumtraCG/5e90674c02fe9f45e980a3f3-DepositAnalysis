import json
from pyspark.sql import SparkSession
spark = SparkSession.builder.getOrCreate()

try:
    BankDeposit_DBFS = DBFSConnector.fetch([], {}, "5e90674c02fe9f45e980a3f4", spark,
                                           "{'url': '/Demo/BankDepositTrain.csv', 'file_type': 'Delimeted', 'delimiter': ',', 'is_header': 'Use Header Line'}")

    BankDeposit_AutoFE = TransformationMain.run(["5e90674c02fe9f45e980a3f4"], {"5e90674c02fe9f45e980a3f4": BankDeposit_DBFS}, "5e90674c02fe9f45e980a3f5", spark, json.dumps({"FE": [{"transformationsData": {}, "feature": "age", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "40.94", "stddev": "11.84", "min": "18", "max": "95", "missing": "0"}}, {"transformationsData": {"feature_label": "job"}, "feature": "job", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "admin.", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "marital"}, "feature": "marital", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "divorced", "max": "single", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "education"}, "feature": "education", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "primary", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "default"}, "feature": "default", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "balance", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "1544.05", "stddev": "3057.56", "min": "-2712", "max": "56831", "missing": "0"}}, {"transformationsData": {"feature_label": "housing"}, "feature": "housing", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "loan"}, "feature": "loan", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "contact"}, "feature": "contact", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "cellular", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "day", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "15.47", "stddev": "8.44", "min": "1", "max": "31", "missing": "0"}}, {"transformationsData": {"feature_label": "month"}, "feature": "month", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "apr", "max": "sep", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "duration", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "371.28", "stddev": "340.99", "min": "3", "max": "3183", "missing": "0"}}, {"transformationsData": {}, "feature": "campaign", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {
                                                "count": "5085", "mean": "2.5", "stddev": "2.57", "min": "1", "max": "41", "missing": "0"}}, {"transformationsData": {}, "feature": "pdays", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "52.87", "stddev": "111.18", "min": "-1", "max": "854", "missing": "0"}}, {"transformationsData": {}, "feature": "previous", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "5085", "mean": "0.83", "stddev": "2.22", "min": "0", "max": "41", "missing": "0"}}, {"transformationsData": {"feature_label": "poutcome"}, "feature": "poutcome", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "failure", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "deposit"}, "feature": "deposit", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "5085", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"feature": "job_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "5085", "mean": "2.77", "stddev": "2.69", "min": "0.0", "max": "11.0", "missing": "0"}}, {"feature": "marital_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.55", "stddev": "0.69", "min": "0", "max": "2", "missing": "0"}}, {"feature": "education_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.72", "stddev": "0.85", "min": "0", "max": "3", "missing": "0"}}, {"feature": "default_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.02", "stddev": "0.12", "min": "0", "max": "1", "missing": "0"}}, {"feature": "housing_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.48", "stddev": "0.5", "min": "0", "max": "1", "missing": "0"}}, {"feature": "loan_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.12", "stddev": "0.33", "min": "0", "max": "1", "missing": "0"}}, {"feature": "contact_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.35", "stddev": "0.61", "min": "0", "max": "2", "missing": "0"}}, {"feature": "month_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "5085", "mean": "3.02", "stddev": "2.86", "min": "0.0", "max": "11.0", "missing": "0"}}, {"feature": "poutcome_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.46", "stddev": "0.87", "min": "0", "max": "3", "missing": "0"}}, {"feature": "deposit_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "5085", "mean": "0.47", "stddev": "0.5", "min": "0", "max": "1", "missing": "0"}}]}))

    functionClassification(BankDeposit_AutoFE, ["age", "job", "marital", "education", "default", "balance", "housing",
                                                "loan", "contact", "day", "month", "duration", "campaign", "pdays", "previous", "poutcome"], "deposit")

except Exception as ex:
    print(ex)
